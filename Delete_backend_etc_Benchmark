import json
import boto3
from boto3.dynamodb.conditions import Attr

def lambda_handler(event, context):
    dynamodb = boto3.resource('dynamodb')
    table = dynamodb.Table('kingdomcome')
    # テーブルからすべてのデータをスキャンする
    #response = table.scan()
    #print(response)    
    #options = {
    #    'FilterExpression' : Attr('Name').contains("\n")
    #}
    response = table.scan()
    items = response['Items']
    #print(items)
    
    table2 = dynamodb.Table('Benchmark')
    
    # 各アイテムに対して改行文字を削除し、更新する
    for lst in items:
        print(lst)
        no_back_space = {k: v[:-1] if v.endswith(' ') else v for k, v in lst.items()}
        no_backn = {k: v.replace('\n','') if isinstance(v, str) else v for k, v in no_back_space.items()}
        no_front_space = {k: v.replace(' ','') if v.startswith(' ') else v for k,v in no_backn.items()}
        print(no_front_space)
        table2.put_item(Item=no_front_space)
        #for k,v in lst.items():
            #updated_item = {k: v.replace('\n', '')}
            #table.put_item(Item=updated_item)
            #print(v)
            
            #if '\n' in v:
                #if isinstance(v, str):
                #v.repalce('\n','')
                #print(v)
            #else:
                #print(v)
                #continue
    #   updated_item = {k: v.replace('\n', '') if isinstance(v, str) else v for k, v in item.items()}
    #table.put_item(Item=updated_item)
    # TODO implement
    return {
        'statusCode': 200,
        'body': json.dumps('delete back_n and ?')
    }
